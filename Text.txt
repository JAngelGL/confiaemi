import NXOpen
import NXOpen.Features
import NXOpen.GeometricUtilities

def create_rectangle():
    # Obtener la sesión de NX y el trabajo en curso
    theSession = NXOpen.Session.GetSession()
    workPart = theSession.Parts.Work
    
    # Crear un nuevo boceto en el plano XY
    sketchName = "Rectángulo"
    sketchOrigin = NXOpen.Point3d(0.0, 0.0, 0.0) # Origen del boceto
    sketchXDirection = NXOpen.Vector3d(1.0, 0.0, 0.0) # Dirección X del boceto
    sketchYDirection = NXOpen.Vector3d(0.0, 1.0, 0.0) # Dirección Y del boceto
    sketchPlane = workPart.Planes.CreatePlane(sketchOrigin, sketchXDirection, sketchYDirection, NXOpen.SmartObject.UpdateOption.WithinModeling)
    sketch = workPart.Sketches.CreateSketch(sketchName, sketchPlane, True)

    # Iniciar el boceto
    sketch.OpenSketch()

    # Definir las coordenadas del rectángulo
    point1 = NXOpen.Point3d(0.0, 0.0, 0.0)
    point2 = NXOpen.Point3d(100.0, 0.0, 0.0) # 100 en X
    point3 = NXOpen.Point3d(100.0, 50.0, 0.0) # 100 en X y 50 en Y
    point4 = NXOpen.Point3d(0.0, 50.0, 0.0) # 50 en Y

    # Crear líneas para formar el rectángulo
    line1 = workPart.Curves.CreateLine(point1, point2)
    line2 = workPart.Curves.CreateLine(point2, point3)
    line3 = workPart.Curves.CreateLine(point3, point4)
    line4 = workPart.Curves.CreateLine(point4, point1)

    # Cerrar el boceto
    sketch.CloseSketch()

if __name__ == '__main__':
    create_rectangle()
